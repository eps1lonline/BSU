from collections import Counter

text = "Дан текст: в первой строке записано количество строк в тексте, а затем сами строки. Выведите все слова, встречающиеся в тексте, по одному на каждую строку. Слова должны быть отсортированы по убыванию их количества появления в тексте, а при одинаковой частоте появления — в лексикографическом порядке."

# Разделить текст на слова, учитывая только буквы и цифры (остальные символы удаляются)
words = text.lower().split()
words = [word.strip('.,!?()-') for word in words]  # Удалить знаки препинания

# Подсчитать количество вхождений каждого слова
word_counts = Counter(words)

# Сортировка слов по убыванию количества вхождений и лексикографическому порядку
sorted_words = sorted(word_counts.items(), key=lambda x: (-x[1], x[0]))

# Вывести слова и их количество в тексте
for word, count in sorted_words:
    print(f"{word}:\t {count} раз")